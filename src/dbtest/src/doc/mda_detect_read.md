
##  mda_detect.py 代码功能
主要用于检测数据库事务之间的并发关系，以及是否存在循环依赖。具体来说，代码通过解析输入的SQL语句，构建事务操作的有向图，检测是否存在循环依赖（即事务之间是否存在无法解决的并发冲突），并输出结果。
### 变量命名含义

| 名称           | 含义                                    | 备注                  |
| ------------ | ------------------------------------- | ------------------- |
| data         | 一次操作信息：type、txn_num、op_time、op_data   |                     |
| data_op_list | 数据操作列表 【数据key：【操作...】， 数据key：【操作...】】 |                     |
| indegree     | 下标：事务号；元素：依赖该事务的事务个数                  |                     |
| edge         | 下标：事务号；元素：该事务的出边                      |                     |
| version_list | key：数据编号；value：数据的值的历史记录              | 下标是 value?          |
| total_num    | 数据库操作总数                               | 对于数据库全表扫描类的操作有关键作用。 |

### 函数列表

| 函数                          | 功能                                                                                                                                                                                               | 备注                              |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------- |
| get_total                   | 获取一个测试文件中 Q0 部分插入的数据个数                                                                                                                                                                           | key 的个数                         |
| find_data                   | 特定位置提取一个数字                                                                                                                                                                                       |                                 |
| set_finish_time             | 在一个数据库操作语句执行完毕后更新相关的时间戳：finishedat<br>1. 所有事务中 begin_ts ｜ end_ts 和 op_time 相等的进行替换<br>2. 所有操作中 op_time 和 op_time 相等的进行替换<br>3. version_list 保存操作历史值 op.value<br>4. op.value 保存 version_list 历史下标 |                                 |
| check_concurrency           | 检查两个事务和是否并发                                                                                                                                                                                      | 通过开始时间和结束时间来判断，默认开始时间之间已经比较过了吗？ |
| get_edge_type               | 确定两个操作之间的边的类型，添加C 标志，跨事务操作，同时返回新的操作顺序                                                                                                                                                            | data1 和 data2 是同一个 Key 的前后两个操作  |
| build_graph                 | 建立一个有向图，这个图表示不同操作之间的并发关系                                                                                                                                                                         | 只会在同一组操作之间建立边                   |
| insert_edge                 | 具体的插边操作（check_concurrency 的前提下插入 get_edge_type 边）：<br>不同事务之间有并发读写冲突；                                                                                                                             | data1 发生时间默认在data2 之前           |
| init_record                 | 根据查询中的信息初始化版本列表中的记录。                                                                                                                                                                             |                                 |
| readVersion_record          | 处理数据库查询操作                                                                                                                                                                                        | 只是更改了： op.value                 |
| read_record                 | 根据查询中的信息读取记录并更新数据操作。增加到 data_op_list 中。                                                                                                                                                          |                                 |
| write_record                | 根据查询和更新数据操作中的信息写入记录。增加到 data_op_list 中。                                                                                                                                                          |                                 |
| delete_record               | 根据查询中的信息删除记录并更新数据操作。增加到 data_op_list 中。                                                                                                                                                          |                                 |
| insert_record               | 根据查询中的信息插入记录并更新数据操作。                                                                                                                                                                             |                                 |
| end_record                  | 设置事务的结束时间戳。                                                                                                                                                                                      |                                 |
| operation_record            | 记录并且处理数据库操作。                                                                                                                                                                                     |                                 |
| remove_unfinished_operation | 删除失败的语句以防止构建冗余边                                                                                                                                                                                  |                                 |
| check_cycle                 | 在有向图中查找环                                                                                                                                                                                         |                                 |
| dfs                         | 在有环的有向图中找环                                                                                                                                                                                       |                                 |
